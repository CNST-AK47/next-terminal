"use strict";(self.webpackChunknext_terminal=self.webpackChunknext_terminal||[]).push([[896],{58374:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(74165),a=n(15861),s=n(43144),c=n(15671),u=n(96675),i=n(74776),o=n.n(i),l=(0,s.Z)((function e(t){var n=this;(0,c.Z)(this,e),this.group="",this.getById=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Z.get("/".concat(n.group,"/").concat(t));case 2:if(1===(a=e.sent).code){e.next=5;break}return e.abrupt("return");case 5:return e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getPaging=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o().stringify(t),e.next=3,u.Z.get("/".concat(n.group,"/paging?").concat(a));case 3:if(1===(s=e.sent).code){e.next=6;break}return e.abrupt("return",{});case 6:return e.abrupt("return",s.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getAll=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Z.get("/".concat(n.group));case 2:if(1===(t=e.sent).code){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",t.data);case 6:case"end":return e.stop()}}),e)}))),this.create=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Z.post("/".concat(n.group),t);case 2:return a=e.sent,e.abrupt("return",1===a.code);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.updateById=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,a){var s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Z.put("/".concat(n.group,"/").concat(t),a);case 2:return s=e.sent,e.abrupt("return",1===s.code);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.deleteById=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Z.delete("/".concat(n.group,"/").concat(t));case 2:return a=e.sent,e.abrupt("return",1===a.code);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.group=t}))},89170:function(e,t,n){var r=n(74165),a=n(15861),s=n(43144),c=n(15671),u=n(60136),i=n(27277),o=n(58374),l=n(96675),d=new(function(e){(0,u.Z)(n,e);var t=(0,i.Z)(n);function n(){var e;return(0,c.Z)(this,n),(e=t.call(this,"user-groups")).GetAll=(0,a.Z)((0,r.Z)().mark((function t(){var n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.Z.get("/".concat(e.group));case 2:if(1===(n=t.sent).code){t.next=5;break}return t.abrupt("return",[]);case 5:return t.abrupt("return",n.data);case 6:case"end":return t.stop()}}),t)}))),e}return(0,s.Z)(n)}(o.Z));t.Z=d},27777:function(e,t,n){var r=n(74165),a=n(15861),s=n(43144),c=n(15671),u=n(60136),i=n(27277),o=n(58374),l=n(96675),d=function(e){(0,u.Z)(n,e);var t=(0,i.Z)(n);function n(){var e;return(0,c.Z)(this,n),(e=t.call(this,"users")).resetTotp=function(){var t=(0,a.Z)((0,r.Z)().mark((function t(n){var a;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.Z.post("/".concat(e.group,"/").concat(n,"/reset-totp"));case 2:return a=t.sent,t.abrupt("return",1===a.code);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.changePassword=function(){var t=(0,a.Z)((0,r.Z)().mark((function t(n,a){var s,c;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=new FormData).set("password",a),t.next=4,l.Z.post("/".concat(e.group,"/").concat(n,"/change-password"),s);case 4:return c=t.sent,t.abrupt("return",1===c.code);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.changeStatus=function(){var t=(0,a.Z)((0,r.Z)().mark((function t(n,a){var s;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.Z.patch("/".concat(e.group,"/").concat(n,"/status?status=").concat(a));case 2:return s=t.sent,t.abrupt("return",1!==s.code);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return(0,s.Z)(n)}(o.Z),p=new d;t.Z=p},99943:function(e,t,n){n.r(t),n.d(t,{default:function(){return L}});var r=n(74165),a=n(15861),s=n(29439),c=n(47313),u=n(15508),i=n(5900),o=n(59491),l=n(25761),d=n(53469),p=n(1413),f=n(12008),h=n(96296),Z=n(66672),v=n(74294),x=n(89170),g=n(27777),m=n(40056),y=n(99925),S=n(46417),k=x.Z,w={labelCol:{span:6},wrapperCol:{span:14}},b=function(e){var t=e.visible,n=e.handleOk,c=e.handleCancel,u=e.confirmLoading,i=e.id,o=f.Z.useForm(),l=(0,s.Z)(o,1)[0];(0,m.useQuery)("userGroupQuery",(function(){return k.getById(i)}),{enabled:t&&y.Z.hasText(i),onSuccess:function(e){e.members=e.members.map((function(e){return e.id})),l.setFieldsValue(e)}});var d=(0,m.useQuery)("usersQuery",g.Z.getAll,{enabled:t}).data||[];return(0,S.jsx)(h.Z,{title:i?"\u66f4\u65b0\u7528\u6237\u7ec4":"\u65b0\u5efa\u7528\u6237\u7ec4",visible:t,maskClosable:!1,destroyOnClose:!0,onOk:function(){l.validateFields().then(function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t);case 2:e.sent&&l.resetFields();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},onCancel:function(){l.resetFields(),c()},confirmLoading:u,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:(0,S.jsxs)(f.Z,(0,p.Z)((0,p.Z)({form:l},w),{},{children:[(0,S.jsx)(f.Z.Item,{name:"id",noStyle:!0,children:(0,S.jsx)(Z.Z,{hidden:!0})}),(0,S.jsx)(f.Z.Item,{label:"\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u7ec4\u540d\u79f0"}],children:(0,S.jsx)(Z.Z,{autoComplete:"off",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u7ec4\u540d\u79f0"})}),(0,S.jsx)(f.Z.Item,{label:"\u7528\u6237\u7ec4\u6210\u5458",name:"members",children:(0,S.jsx)(v.Z,{showSearch:!0,mode:"multiple",allowClear:!0,placeholder:"\u7528\u6237\u7ec4\u6210\u5458",filterOption:!1,children:d.map((function(e){return(0,S.jsx)(v.Z.Option,{value:e.id,children:e.nickname},e.id)}))})})]}))})},C=n(58467),j=n(2135),O=n(88928),I=n(15253),E=n(87591),N=x.Z,T=u.Z.Content,A=c.createRef(),L=function(){var e=(0,c.useState)(!1),t=(0,s.Z)(e,2),n=t[0],u=t[1],p=(0,c.useState)(!1),f=(0,s.Z)(p,2),h=f[0],Z=f[1],v=(0,c.useState)(void 0),x=(0,s.Z)(v,2),g=x[0],m=x[1],y=(0,O.T)(O.Z.USER_GROUP),k=(0,s.Z)(y,2),w=k[0],L=k[1],R=(0,C.s0)(),_=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u540d\u79f0",dataIndex:"name",render:function(e,t){var n=(0,S.jsx)("div",{children:e});return(0,I.c1)("user-group-detail")&&(n=(0,S.jsx)(j.rU,{to:"/user-group/".concat(t.id),children:e})),n}},{title:"\u521b\u5efa\u65f6\u95f4",key:"created",dataIndex:"created",hideInSearch:!0},{title:"\u64cd\u4f5c",valueType:"option",key:"option",render:function(e,t,n,s){return[(0,S.jsx)(E.Z,{menu:"user-group-edit",children:(0,S.jsx)("a",{onClick:function(){u(!0),m(t.id)},children:"\u7f16\u8f91"},"edit")},"user-group-edit"),(0,S.jsx)(E.Z,{menu:"user-group-del",children:(0,S.jsx)(i.Z,{title:"\u60a8\u786e\u8ba4\u8981\u5220\u9664\u6b64\u884c\u5417?",onConfirm:(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.deleteById(t.id);case 2:A.current.reload();case 3:case"end":return e.stop()}}),e)}))),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",children:(0,S.jsx)("a",{className:"danger",children:"\u5220\u9664"},"delete")},"confirm-delete")},"user-group-del"),(0,S.jsx)(l.Z,{onSelect:function(e){switch(e){case"user-group-detail":R("/user-group/".concat(t.id,"?activeKey=info"));break;case"user-group-authorised-asset":R("/user-group/".concat(t.id,"?activeKey=asset"))}},menus:[{key:"user-group-detail",name:"\u8be6\u60c5",disabled:!(0,I.c1)("user-group-detail")},{key:"user-group-authorised-asset",name:"\u6388\u6743\u8d44\u4ea7",disabled:!(0,I.c1)("user-group-authorised-asset")}]},"actionGroup")]}}];return(0,S.jsxs)(T,{className:"page-container",children:[(0,S.jsx)(d.Z,{columns:_,actionRef:A,columnsState:{value:w,onChange:L},request:(0,a.Z)((0,r.Z)().mark((function e(){var t,n,a,s,c,u,i=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},n=i.length>1?i[1]:void 0,i.length>2?i[2]:void 0,a="",s="",Object.keys(n).length>0&&(a=Object.keys(n)[0],s=Object.values(n)[0]),c={pageIndex:t.current,pageSize:t.pageSize,name:t.name,field:a,order:s},e.next=9,N.getPaging(c);case 9:return u=e.sent,e.abrupt("return",{data:u.items,success:!0,total:u.total});case 11:case"end":return e.stop()}}),e)}))),rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:10},dateFormatter:"string",headerTitle:"\u7528\u6237\u7ec4\u5217\u8868",toolBarRender:function(){return[(0,S.jsx)(E.Z,{menu:"user-group-add",children:(0,S.jsx)(o.Z,{type:"primary",onClick:function(){u(!0)},children:"\u65b0\u5efa"},"button")})]}}),(0,S.jsx)(b,{id:g,visible:n,confirmLoading:h,handleCancel:function(){u(!1),m(void 0)},handleOk:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Z(!0),e.prev=1,!t.id){e.next=8;break}return e.next=5,N.updateById(t.id,t);case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,N.create(t);case 10:n=e.sent;case 11:n&&u(!1),A.current.reload();case 13:return e.prev=13,Z(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,,13,16]])})));return function(t){return e.apply(this,arguments)}}()})]})}},87591:function(e,t,n){var r=n(93433),a=n(15253);t.Z=function(e){var t=e.menu,n=e.children;if(Array.isArray(t)){if(a.c1.apply(void 0,(0,r.Z)(t)))return n}else if((0,a.c1)(t))return n}},88928:function(e,t,n){n.d(t,{T:function(){return o}});var r=n(29439),a=n(43144),s=n(15671),c=n(99925),u=n(47313),i=new((0,a.Z)((function e(){(0,s.Z)(this,e),this.ASSET="cs-asset",this.CREDENTIAL="cs-credential",this.COMMAND="cs-command",this.ACCESS_GATEWAY="cs-access-gateway",this.ONLINE_SESSION="cs-online-session",this.OFFLINE_SESSION="cs-offline-session",this.LOGIN_LOG="cs-login-log",this.STORAGE_LOG="cs-storage-log",this.JOB="cs-job",this.STORAGE="cs-storage",this.LOGIN_POLICY="cs-login-policy",this.ACCESS_SECURITY="cs-access-security",this.USER="cs-user",this.ROLE="cs-role",this.USER_GROUP="cs-user-group",this.COMMAND_FILTER="cs-command-filter",this.STRATEGY="cs-strategy"})));t.Z=i;var o=function(e){var t=(0,u.useState)(l(e)),n=(0,r.Z)(t,2),a=n[0],s=n[1];return[a,function(t){new Promise((function(e){s(t),e(t)})).then((function(t){d(e,t)}))}]},l=function(e){switch(e){case i.ASSET:case i.CREDENTIAL:case i.COMMAND:case i.ACCESS_GATEWAY:case i.ONLINE_SESSION:case i.OFFLINE_SESSION:}return p(e,{})},d=function(e,t){localStorage.setItem(e,JSON.stringify(t))},p=function(e,t){var n=localStorage.getItem(e);if(!c.Z.hasText(n))return t;try{return JSON.parse(n)}catch(r){return t}}},99925:function(e,t,n){var r=n(43144),a=n(15671),s=new((0,r.Z)((function e(){(0,a.Z)(this,e),this.hasText=function(e){return!(void 0===e||null===e||0===e.length)},this.zeroPad=function(e,t){for(var n=e.toString();n.length<t;)n="0"+n;return n}})));t.Z=s},25761:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(1413),a=n(44925),s=(n(7202),n(59491)),c=(n(51688),n(78267)),u=(n(96360),n(67251)),i=(n(1923),n(2852)),o=n(46417),l=n(67440),d=n(61033),p=n(46123),f=n.n(p),h=n(47313),Z=(n.p,["key","name"]),v=function(e){var t=e.className,n=e.style,s=e.onSelect,l=e.menus,p=void 0===l?[]:l,v=e.children,x=(0,(0,h.useContext)(i.ZP.ConfigContext).getPrefixCls)("pro-table-dropdown"),g=(0,o.jsx)(u.Z,{onClick:function(e){null===s||void 0===s||s(e.key)},items:p.map((function(e){var t=e.key,n=e.name,s=(0,a.Z)(e,Z);return(0,r.Z)((0,r.Z)({key:t},s),{},{title:s.title,label:n})}))});return(0,o.jsx)(c.Z,{overlay:g,className:f()(x,t),children:(0,o.jsx)("a",{style:n,children:v||(0,o.jsx)(d.Z,{})})})};v.Button=function(e){var t=e.children,n=e.menus,r=e.onSelect,a=e.className,d=e.style,p=(0,(0,h.useContext)(i.ZP.ConfigContext).getPrefixCls)("pro-table-dropdown"),Z=(0,o.jsx)(u.Z,{onClick:function(e){return r&&r(e.key)},items:null===n||void 0===n?void 0:n.map((function(e){return{label:e.name,key:e.key}}))});return(0,o.jsx)(c.Z,{overlay:Z,className:f()(p,a),children:(0,o.jsxs)(s.Z,{style:d,children:[t," ",(0,o.jsx)(l.Z,{})]})})};var x=v}}]);