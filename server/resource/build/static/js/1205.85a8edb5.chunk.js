"use strict";(self.webpackChunknext_terminal=self.webpackChunknext_terminal||[]).push([[1205],{58374:function(e,t,r){r.d(t,{Z:function(){return p}});var n=r(74165),a=r(15861),u=r(43144),c=r(15671),s=r(96675),o=r(74776),i=r.n(o),p=(0,u.Z)((function e(t){var r=this;(0,c.Z)(this,e),this.group="",this.getById=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Z.get("/".concat(r.group,"/").concat(t));case 2:if(1===(a=e.sent).code){e.next=5;break}return e.abrupt("return");case 5:return e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getPaging=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var a,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i().stringify(t),e.next=3,s.Z.get("/".concat(r.group,"/paging?").concat(a));case 3:if(1===(u=e.sent).code){e.next=6;break}return e.abrupt("return",{});case 6:return e.abrupt("return",u.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getAll=(0,a.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Z.get("/".concat(r.group));case 2:if(1===(t=e.sent).code){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",t.data);case 6:case"end":return e.stop()}}),e)}))),this.create=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Z.post("/".concat(r.group),t);case 2:return a=e.sent,e.abrupt("return",1===a.code);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.updateById=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,a){var u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Z.put("/".concat(r.group,"/").concat(t),a);case 2:return u=e.sent,e.abrupt("return",1===u.code);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),this.deleteById=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Z.delete("/".concat(r.group,"/").concat(t));case 2:return a=e.sent,e.abrupt("return",1===a.code);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.group=t}))},66530:function(e,t,r){var n=r(74165),a=r(15861),u=r(43144),c=r(15671),s=r(60136),o=r(27277),i=r(58374),p=r(96675),d=function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(){var e;return(0,c.Z)(this,r),(e=t.call(this,"assets")).GetAll=(0,a.Z)((0,n.Z)().mark((function t(){var r,a,u=arguments;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=u.length>0&&void 0!==u[0]?u[0]:"",t.next=3,p.Z.get("/".concat(e.group,"?protocol=").concat(r));case 3:if(1===(a=t.sent).code){t.next=6;break}return t.abrupt("return",[]);case 6:return t.abrupt("return",a.data);case 7:case"end":return t.stop()}}),t)}))),e.connTest=function(){var t=(0,a.Z)((0,n.Z)().mark((function t(r){var a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.Z.post("/".concat(e.group,"/").concat(r,"/tcping"));case 2:if(1===(a=t.sent).code){t.next=5;break}return t.abrupt("return",[!1,a.message]);case 5:return t.abrupt("return",[a.data.active,a.data.message]);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.importAsset=function(){var t=(0,a.Z)((0,n.Z)().mark((function t(r){var a,u;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("file",r),t.next=4,p.Z.post("/".concat(e.group,"/import"),a,{"Content-Type":"multipart/form-data"});case 4:if(1===(u=t.sent).code){t.next=7;break}return t.abrupt("return",[!1,u.message]);case 7:return t.abrupt("return",[!0,u.data]);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.changeOwner=function(){var t=(0,a.Z)((0,n.Z)().mark((function t(r,a){var u;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.Z.post("/".concat(e.group,"/").concat(r,"/change-owner?owner=").concat(a));case 2:return u=t.sent,t.abrupt("return",1===u.code);case 4:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),e}return(0,u.Z)(r)}(i.Z),f=new d;t.Z=f},29261:function(e,t,r){var n=r(74165),a=r(15861),u=r(43144),c=r(15671),s=r(74776),o=r.n(s),i=r(96675),p=(0,u.Z)((function e(){var t=this;(0,c.Z)(this,e),this.group="authorised",this.GetAssetPaging=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){var a,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o().stringify(r),e.next=3,i.Z.get("/".concat(t.group,"/assets/paging?").concat(a));case 3:if(1===(u=e.sent).code){e.next=6;break}return e.abrupt("return",{});case 6:return e.abrupt("return",u.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.GetUserPaging=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){var a,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o().stringify(r),e.next=3,i.Z.get("/".concat(t.group,"/users/paging?").concat(a));case 3:if(1===(u=e.sent).code){e.next=6;break}return e.abrupt("return",{});case 6:return e.abrupt("return",u.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.GetUserGroupPaging=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){var a,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o().stringify(r),e.next=3,i.Z.get("/".concat(t.group,"/user-groups/paging?").concat(a));case 3:if(1===(u=e.sent).code){e.next=6;break}return e.abrupt("return",{});case 6:return e.abrupt("return",u.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.AuthorisedAssets=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.post("/".concat(t.group,"/assets"),r);case 2:return a=e.sent,e.abrupt("return",1===a.code);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.AuthorisedUsers=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.post("/".concat(t.group,"/users"),r);case 2:return a=e.sent,e.abrupt("return",1===a.code);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.AuthorisedUserGroups=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.post("/".concat(t.group,"/user-groups"),r);case 2:return a=e.sent,e.abrupt("return",1===a.code);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.GetSelected=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){var a,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o().stringify(r),e.next=3,i.Z.get("/".concat(t.group,"/selected?").concat(a));case 3:if(1===(u=e.sent).code){e.next=6;break}return e.abrupt("return",[]);case 6:return e.abrupt("return",u.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.DeleteById=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.delete("/".concat(t.group,"/").concat(r));case 2:return a=e.sent,e.abrupt("return",1===a.code);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),d=new p;t.Z=d},53485:function(e,t,r){var n=r(74165),a=r(15861),u=r(43144),c=r(15671),s=r(60136),o=r(27277),i=r(58374),p=r(96675),d=new(function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(){var e;return(0,c.Z)(this,r),(e=t.call(this,"strategies")).GetAll=(0,a.Z)((0,n.Z)().mark((function t(){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.Z.get("/".concat(e.group));case 2:if(1===(r=t.sent).code){t.next=5;break}return t.abrupt("return",[]);case 5:return t.abrupt("return",r.data);case 6:case"end":return t.stop()}}),t)}))),e}return(0,u.Z)(r)}(i.Z));t.Z=d},27777:function(e,t,r){var n=r(74165),a=r(15861),u=r(43144),c=r(15671),s=r(60136),o=r(27277),i=r(58374),p=r(96675),d=function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(){var e;return(0,c.Z)(this,r),(e=t.call(this,"users")).resetTotp=function(){var t=(0,a.Z)((0,n.Z)().mark((function t(r){var a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.Z.post("/".concat(e.group,"/").concat(r,"/reset-totp"));case 2:return a=t.sent,t.abrupt("return",1===a.code);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.changePassword=function(){var t=(0,a.Z)((0,n.Z)().mark((function t(r,a){var u,c;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(u=new FormData).set("password",a),t.next=4,p.Z.post("/".concat(e.group,"/").concat(r,"/change-password"),u);case 4:return c=t.sent,t.abrupt("return",1===c.code);case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),e.changeStatus=function(){var t=(0,a.Z)((0,n.Z)().mark((function t(r,a){var u;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.Z.patch("/".concat(e.group,"/").concat(r,"/status?status=").concat(a));case 2:return u=t.sent,t.abrupt("return",1!==u.code);case 4:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),e}return(0,u.Z)(r)}(i.Z),f=new d;t.Z=f},21419:function(e,t,r){r.d(t,{Z:function(){return y}});var n=r(74165),a=r(15861),u=r(29439),c=r(47313),s=r(59491),o=r(53469),i=r(29261),p=r(1413),d=r(12008),f=r(96296),l=r(74294),Z=r(66530),h=r(53485),v=r(46417),x={labelCol:{span:6},wrapperCol:{span:14}},g=function(e){var t=e.type,r=e.id,s=e.visible,o=e.handleOk,g=e.handleCancel,w=e.confirmLoading,m=d.Z.useForm(),b=(0,u.Z)(m,1)[0],y=(0,c.useState)([]),k=(0,u.Z)(y,2),I=k[0],j=k[1],C=(0,c.useState)([]),A=(0,u.Z)(C,2),S=A[0],G=A[1],O=(0,c.useState)([]),T=(0,u.Z)(O,2),B=T[0],L=T[1];(0,c.useEffect)((function(){function e(){return e=(0,a.Z)((0,n.Z)().mark((function e(){var a,u,c,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={key:"assetId"},"userId"===t?a.userId=r:a.userGroupId=r,e.next=4,i.Z.GetSelected(a);case 4:return u=e.sent,j(u),e.next=8,Z.Z.GetAll();case 8:return c=e.sent,G(c),e.next=12,h.Z.GetAll();case 12:s=e.sent,L(s);case 14:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}s?function(){e.apply(this,arguments)}():b.resetFields()}),[s]);var P=B.map((function(e){return{value:e.id,label:e.name}})),F=S.map((function(e){return{value:e.id,label:e.name,disabled:I.includes(e.id)}}));return(0,v.jsx)(f.Z,{title:"\u8d44\u4ea7\u6388\u6743",visible:s,maskClosable:!1,destroyOnClose:!0,onOk:function(){b.validateFields().then(function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(t);case 2:e.sent&&b.resetFields();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},onCancel:function(){b.resetFields(),g()},confirmLoading:w,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:(0,v.jsxs)(d.Z,(0,p.Z)((0,p.Z)({form:b},x),{},{children:[(0,v.jsx)(d.Z.Item,{label:"\u8d44\u4ea7",name:"assetIds",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8d44\u4ea7"}],children:(0,v.jsx)(l.Z,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u8d44\u4ea7",showSearch:!0,filterOption:function(e,t){var r;return(null!==(r=null===t||void 0===t?void 0:t.label)&&void 0!==r?r:"").toLowerCase().includes(e.toLowerCase())},options:F})}),(0,v.jsx)(d.Z.Item,{label:"\u6388\u6743\u7b56\u7565",name:"strategyId",extra:"\u53ef\u63a7\u5236\u6388\u6743\u7528\u6237\u4e0a\u4f20\u4e0b\u8f7d\u6587\u4ef6\u7b49\u529f\u80fd",children:(0,v.jsx)(l.Z,{allowClear:!0,style:{width:"100%"},placeholder:"\u6b64\u5b57\u6bb5\u4e0d\u662f\u5fc5\u586b\u7684",showSearch:!0,filterOption:function(e,t){var r;return(null!==(r=null===t||void 0===t?void 0:t.label)&&void 0!==r?r:"").toLowerCase().includes(e.toLowerCase())},options:P})})]}))})},w=r(2135),m=r(87591),b=c.createRef(),y=function(e){var t=e.active,r=e.id,p=e.type,d=(0,c.useState)(!1),f=(0,u.Z)(d,2),l=f[0],Z=f[1],h=(0,c.useState)(!1),x=(0,u.Z)(h,2),y=x[0],k=x[1];(0,c.useEffect)((function(){t&&b.current.reload()}),[t]);var I=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u8d44\u4ea7\u540d\u79f0",dataIndex:"assetName",render:function(e,t){return(0,v.jsx)(w.rU,{to:"/asset/".concat(t.assetId),children:e})}},{title:"\u6388\u6743\u7b56\u7565\u540d\u79f0",dataIndex:"strategyName",hideInSearch:!0,render:function(e,t){return(0,v.jsx)(w.rU,{to:"/strategy/".concat(t.strategyId),children:e})}},{title:"\u6388\u6743\u65e5\u671f",key:"created",dataIndex:"created",hideInSearch:!0},{title:"\u64cd\u4f5c",valueType:"option",key:"option",width:50,render:function(e,t,r,u){return[(0,v.jsx)(m.Z,{menu:["user-unbind-asset","user-group-unbind-asset"],children:(0,v.jsx)("a",{onClick:(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.DeleteById(t.id);case 2:b.current.reload();case 3:case"end":return e.stop()}}),e)}))),children:"\u79fb\u9664"},"unbind")})]}}];return(0,v.jsxs)("div",{children:[(0,v.jsx)(o.Z,{columns:I,actionRef:b,request:(0,a.Z)((0,n.Z)().mark((function e(){var t,a,u,c,s,o,d=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:{},a=d.length>1?d[1]:void 0,d.length>2?d[2]:void 0,u="",c="",Object.keys(a).length>0&&(u=Object.keys(a)[0],c=Object.values(a)[0]),(s={pageIndex:t.current,pageSize:t.pageSize,name:t.name,field:u,order:c})[p]=r,e.next=10,i.Z.GetAssetPaging(s);case 10:return o=e.sent,e.abrupt("return",{data:o.items,success:!0,total:o.total});case 12:case"end":return e.stop()}}),e)}))),rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:10},dateFormatter:"string",headerTitle:"\u6388\u6743\u7684\u8d44\u4ea7\u5217\u8868",toolBarRender:function(){return[(0,v.jsx)(m.Z,{menu:["user-bind-asset","user-group-bind-asset"],children:(0,v.jsx)(s.Z,{type:"primary",onClick:function(){Z(!0)},children:"\u6388\u6743"},"button")})]}}),(0,v.jsx)(g,{type:p,id:r,visible:l,confirmLoading:y,handleCancel:function(){Z(!1)},handleOk:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(!0),t[p]=r;try{i.Z.AuthorisedAssets(t)&&Z(!1),b.current.reload()}finally{k(!1)}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})]})}},60215:function(e,t,r){var n=r(80627),a=r(83371),u=r(27777),c=r(40056),s=r(99925),o=r(46417);t.Z=function(e){var t=e.active,r=e.userId,i=(0,c.useQuery)("getUserById",(function(){return u.Z.getById(r)}),{enabled:t&&s.Z.hasText(r)}),p=i.data||{};return i.isLoading?(0,o.jsx)("div",{className:"page-detail-info",children:(0,o.jsx)(n.Z,{})}):(0,o.jsx)("div",{className:"page-detail-info",children:(0,o.jsxs)(a.Z,{title:"\u57fa\u672c\u4fe1\u606f",column:1,children:[(0,o.jsx)(a.Z.Item,{label:"\u7528\u6237\u540d",children:p.username}),(0,o.jsx)(a.Z.Item,{label:"\u6635\u79f0",children:p.nickname}),(0,o.jsx)(a.Z.Item,{label:"\u90ae\u7bb1",children:p.mail}),(0,o.jsx)(a.Z.Item,{label:"\u72b6\u6001",children:"enabled"===p.status?"\u5f00\u542f":"\u5173\u95ed"}),(0,o.jsx)(a.Z.Item,{label:"\u53cc\u56e0\u7d20\u8ba4\u8bc1",children:p.totpSecret}),(0,o.jsx)(a.Z.Item,{label:"\u6765\u6e90",children:"ldap"===p.source?"LDAP":"\u6570\u636e\u5e93"}),(0,o.jsx)(a.Z.Item,{label:"\u521b\u5efa\u65f6\u95f4",children:p.created})]})})}},87591:function(e,t,r){var n=r(93433),a=r(15253);t.Z=function(e){var t=e.menu,r=e.children;if(Array.isArray(t)){if(a.c1.apply(void 0,(0,n.Z)(t)))return r}else if((0,a.c1)(t))return r}},99925:function(e,t,r){var n=r(43144),a=r(15671),u=new((0,n.Z)((function e(){(0,a.Z)(this,e),this.hasText=function(e){return!(void 0===e||null===e||0===e.length)},this.zeroPad=function(e,t){for(var r=e.toString();r.length<t;)r="0"+r;return r}})));t.Z=u}}]);