"use strict";(self.webpackChunknext_terminal=self.webpackChunknext_terminal||[]).push([[7951],{63663:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var r=n(74165),s=n(15861),a=n(29439),i=n(47313),c=n(15508),l=n(81572),o=n(55291),u=n(94098),d=n(12008),h=n(66672),p=n(59491),Z=n(68001),x=n(45705),f=n(6131),m=n(87569),j=n(96296),w=n(51515),g=n(3598),v=n(40056),y=n(46417),b=l.Z.Title,T=function(){var e,t=(0,v.useQuery)("infoQuery",Z.Z.getUserInfo),n=(0,i.useState)({}),c=(0,a.Z)(n,2),l=c[0],u=c[1],T=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.Z.reloadTotp();case 2:t=e.sent,u(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.secret=l.secret,e.next=3,Z.Z.confirmTotp(n);case 3:if(!e.sent){e.next=9;break}return o.ZP.success("TOTP\u542f\u7528\u6210\u529f"),e.next=8,t.refetch();case 8:u({});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,y.jsxs)("div",{children:[(0,y.jsx)(b,{level:4,children:"\u53cc\u56e0\u7d20\u8ba4\u8bc1"}),(0,y.jsx)(d.Z,{hidden:l.qr,children:(0,y.jsx)(d.Z.Item,{children:null!==(e=t.data)&&void 0!==e&&e.enableTotp?(0,y.jsx)(m.ZP,{status:"success",title:"\u60a8\u5df2\u6210\u529f\u5f00\u542f\u53cc\u56e0\u7d20\u8ba4\u8bc1!",subTitle:"\u591a\u56e0\u7d20\u8ba4\u8bc1-MFA\u4e8c\u6b21\u8ba4\u8bc1-\u767b\u5f55\u8eab\u4efd\u9274\u522b,\u8bbf\u95ee\u63a7\u5236\u66f4\u5b89\u5168\u3002",extra:[(0,y.jsx)(p.Z,{type:"primary",danger:!0,onClick:function(){j.Z.confirm({title:"\u60a8\u786e\u8ba4\u8981\u89e3\u9664\u53cc\u56e0\u7d20\u8ba4\u8bc1\u5417\uff1f",icon:(0,y.jsx)(g.Z,{}),content:"\u89e3\u9664\u4e4b\u540e\u53ef\u80fd\u5b58\u5728\u7cfb\u7edf\u8d26\u53f7\u88ab\u66b4\u529b\u7834\u89e3\u7684\u98ce\u9669\u3002",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.Z.resetTotp();case 2:if(!e.sent){e.next=7;break}return o.ZP.success("\u53cc\u56e0\u7d20\u8ba4\u8bc1\u89e3\u9664\u6210\u529f"),e.next=7,t.refetch();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onCancel:function(){console.log("Cancel")}})},children:"\u89e3\u9664\u7ed1\u5b9a"},"console"),(0,y.jsx)(p.Z,{onClick:T,children:"\u91cd\u65b0\u7ed1\u5b9a"},"re-bind")]}):(0,y.jsx)(m.ZP,{status:"warning",title:"\u60a8\u8fd8\u672a\u5f00\u542f\u53cc\u56e0\u7d20\u8ba4\u8bc1\uff01",subTitle:"\u7cfb\u7edf\u8d26\u53f7\u5b58\u5728\u88ab\u66b4\u529b\u7834\u89e3\u7684\u98ce\u9669\u3002",extra:(0,y.jsx)(p.Z,{type:"primary",onClick:T,children:"\u53bb\u5f00\u542f"},"bind")})})}),function(e){if(e)return(0,y.jsxs)(d.Z,{hidden:!l.qr,onFinish:P,children:[(0,y.jsx)(d.Z.Item,{label:"\u4e8c\u7ef4\u7801",extra:"\u6709\u6548\u671f30\u79d2\uff0c\u5728\u626b\u63cf\u540e\u8bf7\u5c3d\u5feb\u8f93\u5165\u3002\u63a8\u8350\u4f7f\u7528Google Authenticator, Authy \u6216\u8005 Microsoft Authenticator\u3002",children:(0,y.jsxs)(x.Z,{size:12,direction:"horizontal",children:[(0,y.jsx)(f.Z,{style:{padding:20},width:280,src:"data:image/png;base64, "+l.qr}),(0,y.jsx)(p.Z,{type:"primary",icon:(0,y.jsx)(w.Z,{}),onClick:T,children:"\u91cd\u65b0\u52a0\u8f7d"})]})}),(0,y.jsx)(d.Z.Item,{name:"totp",label:"TOTP",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u53cc\u56e0\u7d20\u8ba4\u8bc1APP\u4e2d\u663e\u793a\u7684\u6388\u6743\u7801"}],children:(0,y.jsx)(h.Z,{placeholder:"\u8bf7\u8f93\u5165\u53cc\u56e0\u7d20\u8ba4\u8bc1APP\u4e2d\u663e\u793a\u7684\u6388\u6743\u7801"})}),(0,y.jsx)(d.Z.Item,{children:(0,y.jsx)(p.Z,{type:"primary",htmlType:"submit",children:"\u786e\u8ba4"})})]})}(l.qr)]})},P=c.Z.Content,k=l.Z.Title,C=function(){var e=(0,i.useState)(""),t=(0,a.Z)(e,2),n=t[0],c=t[1],l=(0,i.useState)(""),x=(0,a.Z)(l,2),f=x[0],m=x[1],j=(0,i.useState)({}),w=(0,a.Z)(j,2),g=w[0],v=w[1],b=function(e,t){return t===e?{validateStatus:"success",errorMsg:null}:{validateStatus:"error",errorMsg:"\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4"}},C=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.Z.changePassword(t);case 2:e.sent&&(o.ZP.success("\u5bc6\u7801\u4fee\u6539\u6210\u529f\uff0c\u5373\u5c06\u8df3\u8f6c\u81f3\u767b\u5f55\u9875\u9762"),window.location.href="/#");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(P,{className:"page-container-white",children:(0,y.jsxs)(u.Z,{className:"info-tab",tabPosition:"left",tabBarStyle:{width:150},children:[(0,y.jsxs)(u.Z.TabPane,{tab:"\u4fee\u6539\u5bc6\u7801",children:[(0,y.jsx)(k,{level:4,children:"\u4fee\u6539\u5bc6\u7801"}),(0,y.jsx)("div",{style:{margin:16}}),(0,y.jsxs)(d.Z,{name:"password",onFinish:C,children:[(0,y.jsx)("input",{type:"password",hidden:!0,autoComplete:"new-password"}),(0,y.jsx)(d.Z.Item,{name:"oldPassword",label:"\u539f\u59cb\u5bc6\u7801",rules:[{required:!0,message:"\u539f\u59cb\u5bc6\u7801"}],children:(0,y.jsx)(h.Z,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u539f\u59cb\u5bc6\u7801",style:{width:240}})}),(0,y.jsx)(d.Z.Item,{name:"newPassword",label:"\u65b0\u7684\u5bc6\u7801",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65b0\u7684\u5bc6\u7801"}],children:(0,y.jsx)(h.Z,{type:"password",placeholder:"\u65b0\u7684\u5bc6\u7801",onChange:function(e){return function(e){c(e.target.value),v(b(e.target.value,f))}(e)},style:{width:240}})}),(0,y.jsx)(d.Z.Item,{name:"newPassword2",label:"\u786e\u8ba4\u5bc6\u7801",rules:[{required:!0,message:"\u8bf7\u548c\u4e0a\u9762\u8f93\u5165\u65b0\u7684\u5bc6\u7801\u4fdd\u6301\u4e00\u81f4"}],validateStatus:g.validateStatus,help:g.errorMsg||" ",children:(0,y.jsx)(h.Z,{type:"password",placeholder:"\u8bf7\u548c\u4e0a\u9762\u8f93\u5165\u65b0\u7684\u5bc6\u7801\u4fdd\u6301\u4e00\u81f4",onChange:function(e){return function(e){m(e.target.value),v(b(n,e.target.value))}(e)},style:{width:240}})}),(0,y.jsx)(d.Z.Item,{children:(0,y.jsx)(p.Z,{disabled:g.errorMsg||!g.validateStatus,type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]})]},"change-password"),(0,y.jsx)(u.Z.TabPane,{tab:"\u4e24\u6b65\u8ba4\u8bc1",children:(0,y.jsx)(T,{})},"totp")]})})})}},51515:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(1413),s=n(47313),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},i=n(95734),c=function(e,t){return s.createElement(i.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:a}))};c.displayName="ReloadOutlined";var l=s.forwardRef(c)},81180:function(e,t,n){var r=n(35620);t.Z=r.Z}}]);