"use strict";(self.webpackChunknext_terminal=self.webpackChunknext_terminal||[]).push([[2662],{72662:function(e,n,t){t.r(n);var r=t(74165),a=t(15861),o=t(44925),i=t(29439),l=t(47313),c=t(88928),d=t(15508),s=t(74294),u=t(57325),m=t(66204),p=t(59491),f=t(55291),h=t(5900),v=t(53469),x=t(95519),Z=t(9388),y=t(96216),k=t(37389),I=t(87591),g=t(40056),j=t(27777),w=t(66530),b=t(46417),S=["type","defaultRender"],T=["type","defaultRender"],C=["type","defaultRender"],O=d.Z.Content,R=l.createRef(),N=x.Z;n.default=function(){var e,n,t=(0,c.T)(c.Z.ONLINE_SESSION),l=(0,i.Z)(t,2),d=l[0],x=l[1],L=(0,g.useQuery)("userQuery",j.Z.getAll),D=(0,g.useQuery)("assetQuery",w.Z.getAll),P=null===(e=L.data)||void 0===e?void 0:e.map((function(e){return{label:e.nickname,value:e.id}})),z=null===(n=D.data)||void 0===n?void 0:n.map((function(e){return{label:e.name,value:e.id}})),F=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u6765\u6e90IP",dataIndex:"clientIp",key:"clientIp"},{title:"\u7528\u6237\u6635\u79f0",dataIndex:"creatorName",key:"creatorName",renderFormItem:function(e,n,t){var r=n.type;n.defaultRender,(0,o.Z)(n,S);return"form"===r?null:(0,b.jsx)(s.Z,{showSearch:!0,filterOption:function(e,n){var t;return(null!==(t=null===n||void 0===n?void 0:n.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},allowClear:!0,options:P})}},{title:"\u8d44\u4ea7\u540d\u79f0",dataIndex:"assetName",key:"assetName",renderFormItem:function(e,n,t){var r=n.type;n.defaultRender,(0,o.Z)(n,T);return"form"===r?null:(0,b.jsx)(s.Z,{showSearch:!0,filterOption:function(e,n){var t;return(null!==(t=null===n||void 0===n?void 0:n.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},allowClear:!0,options:z})}},{title:"\u8fde\u63a5\u534f\u8bae",dataIndex:"protocol",key:"protocol",render:function(e,n){var t="".concat(n.username,"@").concat(n.ip,":").concat(n.port);return(0,b.jsx)(u.Z,{title:t,children:(0,b.jsx)(m.Z,{color:Z.f[e],children:e})})},renderFormItem:function(e,n,t){var r=n.type;n.defaultRender,(0,o.Z)(n,C);return"form"===r?null:(0,b.jsxs)(s.Z,{children:[(0,b.jsx)(s.Z.Option,{value:"rdp",children:"RDP"}),(0,b.jsx)(s.Z.Option,{value:"ssh",children:"SSH"}),(0,b.jsx)(s.Z.Option,{value:"telnet",children:"Telnet"}),(0,b.jsx)(s.Z.Option,{value:"kubernetes",children:"Kubernetes"})]})}},{title:"\u63a5\u5165\u65f6\u95f4",dataIndex:"connectedTime",key:"connectedTime",hideInSearch:!0},{title:"\u63a5\u5165\u65f6\u957f",dataIndex:"connectedTimeDur",key:"connectedTimeDur",render:function(e,n){return n.connectedTime?(0,y.I6)(new Date(n.connectedTime),new Date):"-"},hideInSearch:!0},{title:"\u64cd\u4f5c",valueType:"option",key:"option",render:function(e,n,t,o){return[(0,b.jsx)(I.Z,{menu:"online-session-monitor",children:(0,b.jsx)(p.Z,{type:"link",size:"small",onClick:function(){switch(n.mode){case"naive":case"native":case"terminal":(0,k.L)("#/term-monitor?sessionId=".concat(n.id),n.id,1024,768);break;case"guacd":(0,k.L)("#/guacd-monitor?sessionId=".concat(n.id),n.id,1024,768);break;default:f.ZP.info("\u6570\u636e\u5f02\u5e38")}},children:"\u76d1\u63a7"},"monitor")},"online-session-monitor"),(0,b.jsx)(I.Z,{menu:"online-session-disconnect",children:(0,b.jsx)(h.Z,{title:"\u60a8\u786e\u5b9a\u8981\u65ad\u5f00\u6b64\u4f1a\u8bdd\u5417?",onConfirm:(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.disconnect(n.id);case 2:R.current.reload();case 3:case"end":return e.stop()}}),e)}))),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",children:(0,b.jsx)("a",{className:"danger",children:"\u65ad\u5f00"},"delete")},"confirm-disconnect")},"online-session-disconnect")]}}];return(0,b.jsx)(O,{className:"page-container",children:(0,b.jsx)(v.Z,{columns:F,actionRef:R,columnsState:{value:d,onChange:x},request:(0,a.Z)((0,r.Z)().mark((function e(){var n,t,a,o,i,l,c=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>0&&void 0!==c[0]?c[0]:{},t=c.length>1?c[1]:void 0,c.length>2?c[2]:void 0,a="",o="",Object.keys(t).length>0&&(a=Object.keys(t)[0],o=Object.values(t)[0]),i={pageIndex:n.current,pageSize:n.pageSize,protocol:n.protocol,field:a,order:o,status:"connected"},e.next=9,N.getPaging(i);case 9:return l=e.sent,e.abrupt("return",{data:l.items,success:!0,total:l.total});case 11:case"end":return e.stop()}}),e)}))),rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:10},dateFormatter:"string",headerTitle:"\u5728\u7ebf\u4f1a\u8bdd\u5217\u8868",toolBarRender:function(){return[]}})})}}}]);